{"rules":{"rooms":{"$owner_id":{".read":"$owner_id === auth.uid && query.orderByChild === 'created_at'",".indexOn":["created_at"],"$own_room_id":{".read":"$owner_id === auth.uid",".validate":"$own_room_id.matches(/^[0-2]$/) && newData.hasChild('public_info') && (data.exists() || $owner_id === auth.uid && auth.token.email_verified === true)","public_info":{".read":"auth.uid === $owner_id || root.child('room_members_info/'+data.child('room_id').val()+'/accepted/'+auth.uid).val() === true",".write":"newData.exists() || ($owner_id === auth.uid && !newData.parent().parent().parent().parent().child('room_entrances/'+data.child('room_id').val()).exists() && !newData.parent().parent().parent().parent().hasChild('room_members_info/'+data.child('room_id').val()))",".validate":"newData.hasChildren(['room_id']) && (data.exists() || (auth.uid === $owner_id && auth.token.email_verified === true))","room_id":{".validate":"newData.isString() && (!data.exists() || newData.val() === data.val()) && newData.parent().parent().parent().parent().parent().child('room_entrances/'+newData.parent().child('room_id').val()).exists() && newData.parent().parent().parent().parent().parent().hasChild('room_members_info/'+newData.val()+'/requesting/password')"},"$other":{".validate":false}},"$other":{".validate":false}}}},"room_entrances":{".read":"auth !== null && ((query.orderByKey !== null && query.equalTo !== null && query.limitToFirst === 1) || (query.orderByChild === 'owner_id' && query.equalTo === auth.uid && query.limitToFirst <= 10) || (query.orderByChild === 'room_name' && query.startAt !== null && query.endAt !== null && query.limitToFirst <= 10) || (query.orderByChild === 'members_count' && query.startAt !== null && query.endAt !== null && (query.limitToFirst === null ? query.limitToLast <= 10 : query.limitToFirst <= 10)) || (query.orderByChild === 'created_at' && (query.limitToFirst === null ? query.limitToLast <= 10 : query.limitToFirst <= 10)))",".indexOn":["created_at"],"$room_id":{".write":"(!data.exists() ? auth.uid === newData.child('owner_id').val() : (auth.uid === data.child('owner_id').val() || root.hasChild('room_members_info/'+$room_id+'/accepted/'+auth.uid))) && newData.exists() === newData.parent().parent().hasChild('rooms/'+(newData.exists() ? newData : data).child('owner_id').val()+'/'+(newData.exists() ? newData : data).child('own_room_id').val())",".validate":"newData.hasChildren(['owner_id','own_room_id','room_name','members_count','created_at']) && $room_id === newData.parent().parent().child('rooms/'+newData.child('owner_id').val()+'/'+newData.child('own_room_id').val()+'/public_info/room_id').val()","owner_id":{".validate":"newData.val() === auth.uid && newData.parent().parent().parent().hasChild('rooms/'+newData.val()) && (!data.exists() || newData.val() === data.val())"},"own_room_id":{".validate":"newData.isString() && newData.parent().parent().parent().hasChild('rooms/'+newData.parent().child('owner_id').val()+'/'+newData.val()) && (!data.exists() || newData.val() === data.val())"},"room_name":{".validate":"newData.isString() && 0 < newData.val().length && newData.val().length < 20 && auth.uid === newData.parent().child('owner_id').val()"},"members_count":{".validate":"newData.isNumber() && 1 <= newData.val() && newData.val() < 100000 && (!data.exists() ? newData.val() === 1 : (auth.uid === data.parent().child('owner_id').val() ? (newData.val() === 1 || newData.val() === data.val()) : (root.child('room_members_info/'+$room_id+'/accepted/'+auth.uid).exists() && ((newData.val() === data.val() && (root.child('room_members_info/'+$room_id+'/accepted/'+auth.uid).val() === true) === (newData.parent().parent().parent().child('room_members_info/'+$room_id+'/accepted/'+auth.uid).val() === true)) || (newData.val() === data.val() + 1 && !root.child('room_members_info/'+$room_id+'/denied/'+auth.uid).exists() && root.child('room_members_info/'+$room_id+'/accepted/'+auth.uid).val() === false && newData.parent().parent().parent().child('room_members_info/'+$room_id+'/accepted/'+auth.uid).val() === true) || (newData.val() === data.val() - 1 && root.child('room_members_info/'+$room_id+'/accepted/'+auth.uid).val() === true && newData.parent().parent().parent().child('room_members_info/'+$room_id+'/accepted/'+auth.uid).val() !== true)))))"},"created_at":{".validate":"newData.isNumber() && 0 < newData.val() && newData.val() <= now && (!data.exists() || newData.val() === data.val())"},"$other":{".validate":false}}},"room_members_info":{"$room_id":{"requesting":{".read":"auth.uid === root.child('room_entrances/'+$room_id+'/owner_id').val() || (data.child('password').val().length === 0 && query.orderByKey && query.equalTo === 'password')",".validate":"newData.hasChild('password')","password":{".write":"auth.uid === (data.exists() ? root : newData.parent().parent().parent().parent()).child('room_entrances/'+$room_id+'/owner_id').val() && newData.exists() === newData.parent().parent().parent().parent().child('room_entrances/'+$room_id).exists()",".validate":"newData.isString() && newData.val().length < 20"},"$user_id":{".write":"(!newData.exists() && (auth.uid === root.child('room_entrances/'+$room_id+'/owner_id').val() || auth.uid === $user_id)) || (!data.exists() && $user_id === auth.uid && root.child('room_entrances/'+$room_id).exists() && !data.parent().parent().child('accepted/'+$user_id).exists() && !data.parent().parent().child('denied/'+$user_id).exists())",".validate":"newData.hasChild('password') && $user_id !== newData.parent().parent().parent().parent().child('room_entrances/'+$room_id+'/owner_id').val()","password":{".validate":"newData.isString() && newData.val() === data.parent().parent().child('password').val()"}}},"accepted":{"$user_id":{".write":"!newData.exists() ? ((auth.uid === root.child('room_entrances/'+$room_id+'/owner_id').val() && !newData.parent().exists() && (!newData.parent().parent().parent().parent().child('room_entrances/'+$room_id).exists() || newData.parent().parent().parent().parent().child('room_entrances/'+$room_id+'/members_count').val() === 1)) || ($user_id === auth.uid && (data.val() !== true || newData.parent().parent().parent().parent().child('room_entrances/'+$room_id+'/members_count').val() === root.child('room_entrances/'+$room_id+'/members_count').val() - 1))) : (auth.uid === root.child('room_entrances/'+$room_id+'/owner_id').val() || auth.uid === $user_id)",".validate":"newData.isBoolean() && (!data.exists() ? (auth.uid === newData.parent().parent().parent().parent().child('room_entrances/'+$room_id+'/owner_id').val() && $user_id !== newData.parent().parent().parent().parent().child('room_entrances/'+$room_id+'/owner_id').val() && data.parent().parent().child('requesting/'+$user_id).exists() && !newData.parent().parent().child('requesting/'+$user_id).exists() && newData.val() === false) : (auth.uid === $user_id && (!data.parent().parent().child('denied/'+$user_id).exists() || newData.val() === false) && ((newData.val() === data.val() && newData.parent().parent().parent().parent().child('room_entrances/'+$room_id+'/members_count').val() === root.child('room_entrances/'+$room_id+'/members_count').val()) || (newData.parent().parent().parent().parent().child('room_entrances/'+$room_id+'/members_count').val() === root.child('room_entrances/'+$room_id+'/members_count').val() + (newData.val() === true ? 1 : -1)))))"}},"denied":{".write":"auth.uid === root.child('room_entrances/'+$room_id+'/owner_id').val()",".validate":"!(newData.isBoolean() || newData.isNumber() || newData.isString())","$user_id":{".validate":"newData.val() === false && auth.uid !== $user_id && $user_id !== root.child('room_entrances/'+$room_id+'/owner_id').val()"}},"$other":{".validate":false}}},"$other":{".validate":false}}}